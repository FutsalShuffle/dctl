---
version: '3'
{{$projectName := .Name}} {{$docker := .Docker}}
services:
{{range $index, $container := .Containers}}  {{$index}}:
    container_name: {{$projectName}}_{{$index}}
    {{if not $container.Image}}image: {{if $docker.Registry}}{{$docker.Registry}}/{{end}}{{$projectName}}/{{$index}}:prod-latest{{end}}
{{toYaml $container | indent 4 }}
{{end}}